{% extends 'base.html' %}
{% load static %}

{% block title %}
Arena
{% endblock %}

{% block content %}
<!-- <style type="text/css">
    #map {
        height: 200px;
        width: 400px;
    }
</style> -->
<br>
<div class="d-flex justify-content-center">
    <div class="arena-header">
    <h1 class="arenah1">ROBO VAC BATTLE ARENA</h1>
    </div>
</div>
<br>
<br>


<div class="d-flex justify-content-center">
    <div id="forms">
        <div class="form">
            <h2 id="arena-text">Create a Match Request</h2>
            <form action="{% url 'match_request' %}" method="POST">
                {% csrf_token %}

                <h4 id="arena-text">Bot Name:</h4>
                <div class="form-group row">
                    <div class="col-sm-10">
                      <input name="bot_name" class="form-control" placeholder="Input your bot name here">
                    </div>
                  </div>

                  <h4 id="arena-text">Match Details:</h4>
                  <div class="form-group row">
                    <div class="col-sm-10">
                      <textarea name="details" class="form-control" placeholder="Match Details" cols="40" rows="5"></textarea>
                    </div>
                  </div>

                <br>

                <h4 id="arena-text">Requested Match Location:</h4>
                <div class="form-group row">
                    <div class="col-sm-10">
                      <input name="user_address" class="form-control">
                    </div>
                  </div>
                <button type="submit" name="Submit Request" class="btn btn-secondary">Submit</button>

            </form>
        </div>
    </div>
</div>

<br>
<br>

<div class="d-flex justify-content-center">
    <div class="d-flex justify-content-center">
    <div id="map"></div>
    <table class="table table-bordered table-hover">
        <thead class="thead-light">
          <tr>
            <th scope="col">Bot Name</th>
            <th scope="col">Bot Owner</th>
            <th scope="col">Match Details</th>
            <th scope="col">Match Location</th>
          </tr>
        </thead>
        <tbody>
        {% for request in user_requests %}
          <tr class="table-light">
            <th scope="row">{{request.bot_name}}</th>
            <td>{{request.owner}}</td>
            <td>{{request.body}}</td>
            <td>{{request.location}}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
</div>


<script>
    function initMap() {
        var geocoder = new google.maps.Geocoder();
        var user_address = document.getElementByClass('user_address').innerHTML;
        geocoder.geocode({ 'address': user_address }), function (results, status) {
            if (status == 'OK') {
                console.log('results')
                var latLng = results[0].geometry.location;
                map = new google.maps.Map(document.getElementById('map'), {
                    center: latLng,
                    zoom: 8,
                });
                var marker = new google.maps.Marker({ position: location, map: map });
            } else {
                alert("ERROR " + status);
                map = new google.maps.Map(document.getElementById('map'), {
                    center: location,
                    zoom: 8,
                });
            }
        }
    }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-CWd07gsMBS06eKpLCoYO3K2X5Q3xWh0&callback=initMap&libraries=&v=weekly"></script>


{% endblock %}